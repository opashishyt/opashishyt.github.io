// ====== FRP BYPASS BY ASHISH - GITHUB PAGES FIXED ======
// Version: 3.0.0 - Access Denied Problem Solved
// This file is optimized for GitHub Pages

// ====== APP DATA ======
let apps = [
    {number: 1, name: 'Galaxy Store', icon: 'fas fa-store', color: 'samsung', url: 'intent://com.sec.android.app.samsungapps/#Intent;scheme=android-app;end', category: 'Samsung'},
    {number: 2, name: 'Google Search', icon: 'fab fa-google', color: 'google', url: 'intent://com.google.android.googlequicksearchbox/#Intent;scheme=android-app;end', category: 'Google'},
    {number: 3, name: 'System Settings', icon: 'fas fa-cog', color: 'system', url: 'intent://com.android.settings/#Intent;scheme=android-app;end', category: 'System'},
    {number: 4, name: 'YouTube', icon: 'fab fa-youtube', color: 'youtube', url: 'intent://com.google.android.youtube/#Intent;scheme=android-app;end', category: 'Google'},
    {number: 5, name: 'Chrome', icon: 'fab fa-chrome', color: 'chrome', url: 'intent://com.android.chrome/#Intent;scheme=android-app;end', category: 'Google'},
    {number: 6, name: 'Calculator', icon: 'fas fa-calculator', color: 'calculator', url: 'intent://com.google.android.calculator/#Intent;scheme=android-app;end', category: 'Tools'}
];

let files = [
    {name: 'FRP_Bypass.apk', icon: 'fas fa-file-archive', color: 'archive', url: '#', category: 'APK'},
    {name: 'Activity_Launcher.apk', icon: 'fas fa-file-archive', color: 'archive', url: '#', category: 'APK'}
];

// ====== LOAD FROM LOCALSTORAGE ======
function loadFromStorage() {
    const savedApps = localStorage.getItem('frp_apps_fixed');
    const savedFiles = localStorage.getItem('frp_files_fixed');
    
    if (savedApps) {
        try {
            apps = JSON.parse(savedApps);
        } catch(e) {
            console.log('Using default apps');
        }
    }
    
    if (savedFiles) {
        try {
            files = JSON.parse(savedFiles);
        } catch(e) {
            console.log('Using default files');
        }
    }
}

// ====== SAVE TO LOCALSTORAGE ======
function saveToStorage() {
    localStorage.setItem('frp_apps_fixed', JSON.stringify(apps));
    localStorage.setItem('frp_files_fixed', JSON.stringify(files));
}

// ====== RENDER GRID ======
function renderGrid() {
    const launcher = document.getElementById('launcher');
    if (!launcher) return;
    
    launcher.innerHTML = '';
    
    apps.sort((a, b) => a.number - b.number);
    
    for (let i = 1; i <= 30; i++) {
        const app = apps.find(a => a.number === i);
        const gridItem = document.createElement('div');
        gridItem.className = 'grid-item';
        
        if (app) {
            gridItem.innerHTML = `
                <div class="item-icon color-${app.color || 'default'}">
                    <i class="${app.icon}"></i>
                </div>
                <div class="item-name">${app.name}</div>
                <button class="btn-launch" onclick="launchApp(${i})">
                    <i class="fas fa-rocket"></i> OPEN
                </button>
            `;
        } else {
            gridItem.innerHTML = `
                <div class="item-icon color-default">
                    <i class="fas fa-plus"></i>
                </div>
                <div class="item-name">Empty Slot</div>
                <button class="btn-launch" onclick="addToPosition(${i})">
                    <i class="fas fa-plus"></i> ADD
                </button>
            `;
        }
        
        launcher.appendChild(gridItem);
    }
}

// ====== LAUNCH APP ======
window.launchApp = function(position) {
    const app = apps.find(a => a.number === position);
    if (!app) {
        alert('Position ' + position + ' is empty');
        return;
    }
    
    document.getElementById('statusTitle').innerText = 'Opening ' + app.name + '...';
    
    try {
        if (app.url.startsWith('intent://') || app.url.startsWith('tel:')) {
            window.location.href = app.url;
        } else if (app.url.startsWith('http')) {
            window.open(app.url, '_blank');
        } else {
            alert('Cannot open ' + app.name);
        }
    } catch(e) {
        alert('Error opening app');
    }
    
    setTimeout(() => {
        document.getElementById('statusTitle').innerText = 'FRP Bypass Tools';
    }, 2000);
};

// ====== ADMIN FUNCTIONS ======
window.openAdmin = function() {
    document.getElementById('adminModal').style.display = 'flex';
};

window.closeAdmin = function() {
    document.getElementById('adminModal').style.display = 'none';
};

window.login = function() {
    const user = document.getElementById('adminUser').value;
    const pass = document.getElementById('adminPass').value;
    
    if (user === 'opashishyt' && pass === 'Ashish@2006') {
        document.getElementById('loginBox').style.display = 'none';
        document.getElementById('adminArea').style.display = 'block';
        document.getElementById('loginErr').style.display = 'none';
        loadAdminPanel();
    } else {
        document.getElementById('loginErr').style.display = 'block';
    }
};

function loadAdminPanel() {
    const adminApps = document.getElementById('adminApps');
    if (!adminApps) return;
    
    adminApps.innerHTML = '';
    apps.forEach((app, index) => {
        const div = document.createElement('div');
        div.className = 'admin-item';
        div.innerHTML = `
            <span>#${app.number} - ${app.name}</span>
            <button onclick="deleteApp(${index})" class="btn-delete">
                <i class="fas fa-trash"></i>
            </button>
        `;
        adminApps.appendChild(div);
    });
}

window.deleteApp = function(index) {
    if (confirm('Delete ' + apps[index].name + '?')) {
        apps.splice(index, 1);
        saveToStorage();
        renderGrid();
        loadAdminPanel();
    }
};

window.logout = function() {
    document.getElementById('adminArea').style.display = 'none';
    document.getElementById('loginBox').style.display = 'block';
    closeAdmin();
};

window.addToPosition = function(position) {
    openAdmin();
    alert('Admin login required to add app at position ' + position);
};

// ====== INITIALIZE ======
document.addEventListener('DOMContentLoaded', function() {
    console.log('FRP Bypass - GitHub Pages Fixed Version');
    loadFromStorage();
    renderGrid();
    
    // Update status
    const statusEl = document.getElementById('statusTitle');
    if (statusEl) {
        statusEl.innerText = 'FRP Bypass Tools Ready';
    }
});